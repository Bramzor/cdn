/* See uncompressed version here: https://github.com/simpleanalytics/cdn.simpleanalytics.io/blob/master/hello.js */

!function(i,c){try{if(!i)return;var h,u=i.navigator,l=i.location,p=i.document,d=u.userAgent,e=p.querySelector('script[src="https://cdn.simpleanalytics.io/hello.js"]'),f=e?e.getAttribute("data-mode"):null,g=function(e){console&&console.warn&&console.warn("Simple Analytics: "+e)};if(-1<d.search(/(bot|spider|crawl)/gi))return g("Not sending requests because user agent is a robot");var t=function(e){var t=e&&e.isPushState,r=l.protocol+"//"+l.hostname+l.pathname;if("hash"===f&&l.hash&&(r+=l.hash.split("?")[0]),h!==r){if(h=r,"visibilityState"in p&&"prerender"===p.visibilityState)return g("Not sending requests when prerender");if("doNotTrack"in u&&"1"===u.doNotTrack)return g("Not sending requests when doNotTrack is enabled");if("localhost"===l.hostname)return g("Not sending requests from localhost");var n=l.search.match(/[?&](utm_source|source|ref)=([^?&]+)/gi),s=n?n.map(function(e){return e.split("=")[1]}):[],a={source:"js",url:r};d&&(a.ua=d),s&&s[0]&&(a.urlReferrer=s[0]),p.referrer&&!t&&(a.referrer=p.referrer),i.innerWidth&&(a.width=i.innerWidth);var o=new XMLHttpRequest;o.open("POST",c+"/post",!0),o.setRequestHeader("Content-Type","text/plain; charset=UTF-8"),o.send(JSON.stringify(a))}},r=i.history;if(r&&r.pushState&&Event&&i.dispatchEvent){r.pushState=(a=r[s="pushState"],function(){var e=a.apply(this,arguments),t=new Event(s);return t.arguments=arguments,i.dispatchEvent(t),e}),i.addEventListener("pushState",function(){t({isPushState:!0})})}"hash"===f&&"onhashchange"in i&&(i.onhashchange=t),t()}catch(e){console&&console.error&&console.error(e);var n=c+"/hello.gif";e&&e.message&&(n=n+"?error="+encodeURIComponent(e.message)),(new Image).src=n}var s,a}(window,"https://api.simpleanalytics.io");
